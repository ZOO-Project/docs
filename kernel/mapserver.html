

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Optional MapServer support &mdash; ZOO-Project 1.9.0 documentation</title>
  
  <link href="https://fonts.googleapis.com/css?family=Days+One" rel="stylesheet" type="text/css">
  
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml" title="Search within ZOO-Project 1.9.0 documentation" href="../_static/opensearch.xml"/>
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="ZOO-Project 1.9.0 documentation" href="../index.html"/>
        <link rel="up" title="ZOO-Kernel" href="index.html"/>
        <link rel="next" title="Optional Orfeo Toolbox support" href="orfeotoolbox.html"/>
        <link rel="prev" title="ZOO-Kernel configuration" href="configuration.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
	  <a class="shrink" href="http://zoo-project.org"><img src="/docs/_static/zoo-sun-logo.png" class="img-responsive sun" style="display: inline;"> ZOO</a>
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#what-is-zoo-project">What is ZOO-Project ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#zoo-project-components">ZOO-Project components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#open-source">Open Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">ZOO-Project installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/download.html">Download</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/installation.html">Installation on Unix/Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/debian.html">Installation on Debian / Ubuntu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/opensuse.html">Install on OpenSUSE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/centos.html">Installation on CentOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/windows.html">Installation on Windows ™</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ZOO-Kernel</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="what.html">What is ZOO-Kernel ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">ZOO-Kernel configuration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Optional MapServer support</a></li>
<li class="toctree-l2"><a class="reference internal" href="orfeotoolbox.html">Optional Orfeo Toolbox support</a></li>
<li class="toctree-l2"><a class="reference internal" href="sagagis.html">Optional SAGA GIS support</a></li>
<li class="toctree-l2"><a class="reference internal" href="hpc.html">Optional HPC support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../services/index.html">ZOO-Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../services/what.html">What are ZOO-Services ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/zcfg-reference.html">ZOO-Service configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/process-profiles.html">Process profiles registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/howtos.html">Create your own ZOO-Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/translation.html">Translation Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/status.html">ZOO Status Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/debug.html">Debugging ZOO Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/zoo-services.html">Available ZOO-Services</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">ZOO-API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/what.html">What is ZOO-API ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/howto.html">Using ZOO-API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/classes.html">ZOO-API Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/examples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../client/index.html">ZOO-Client</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../client/what.html">What is ZOO-Client ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client/howto.html">Using ZOO-Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../client/example.html">Example application</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contributor Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contribute/howto.html">How to contribute ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/code.html">Contribute code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/doc.html">Contribute documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/dev.html">Committer guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/release.html">Release Procedure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/translate.html">Contribute translation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribute/contributors.html">List of contributors</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ZOO-Project</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html"> Documentation</a> &#8725; &#160;</li>
      
          <li><a href="index.html">ZOO-Kernel</a> &#8725; &#160;</li>
      
    <li>Optional MapServer support</li>
      <li class="wy-breadcrumbs-aside">
       $Date$
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <section id="optional-mapserver-support">
<span id="kernel-mapserver"></span><h1>Optional MapServer support<a class="headerlink" href="#optional-mapserver-support" title="Permalink to this heading">¶</a></h1>
<p>Processing geospatial data using WPS Services is usefull. Publishing their results directly as WMS, WFS or WCS ressources is even more convenient. This is possible since <a class="reference external" href="http://zoo-project.org">ZOO-Project 1.3</a> using the <strong>optional MapServer support</strong>. The latter thus allows for automatic publication of WPS Service output as WMS/WFS or WCS using a <a class="reference internal" href="index.html#kernel-index"><span class="std std-ref">ZOO-Kernel</span></a> specific internal mechanism which is detailed in this section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="../_images/mapserver.png"><img alt="MapServer logo" src="../_images/mapserver.png" style="width: 37.0px; height: 37.0px;" /></a> <a class="reference external" href="http://mapserver.org">MapServer</a> is an open source WMS/WFS/WCS server. Learn more by reading its <a class="reference external" href="http://mapserver.org/documentation.html">documentation</a>.</p>
</div>
<section id="how-does-it-work">
<h2>How does it work ?<a class="headerlink" href="#how-does-it-work" title="Permalink to this heading">¶</a></h2>
<p>If a request with <code class="docutils literal notranslate"><span class="pre">mimeType=image/png</span></code> is sent to <a class="reference internal" href="index.html#kernel-index"><span class="std std-ref">ZOO-Kernel</span></a>, the latter will detect that the <em>useMapServer</em> option is set to true an it will automatically:</p>
<blockquote>
<div><ul class="simple">
<li><p>Execute the service using the <em>&lt;Default&gt;</em> block definition (these values must be understood by <a class="reference external" href="http:/gdal.org">GDAL</a>)</p></li>
<li><p>Store the resulting output on disk (in the <code class="docutils literal notranslate"><span class="pre">[main]</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">dataPath</span></code> directory)</p></li>
<li><p>Write a <a class="reference external" href="http://mapserver.org/mapfile/index.html">mapfile</a> (in the <code class="docutils literal notranslate"><span class="pre">[main]</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">dataPath</span></code> directory) using the <a class="reference external" href="http://mapserver.org">MapServer</a> C-API (this sets up both WMS and WFS services).</p></li>
</ul>
</div></blockquote>
<p>Existing WPS Services source code doesn’t need to be modified once the MapServer support is activated. It only takes to edit their respective <a class="reference internal" href="../services/zcfg-reference.html#services-zcfg"><span class="std std-ref">ZOO-Service configuration file</span></a> files accordingly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case of a vector data source output, both WMS and WFS configuration are included by default in the resulting mapfile.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case of a raster data source output, both WMS and WCS configuration are included by default in the resulting mapfile.</p>
</div>
<p>Depending on the requests, ZOO-Kernel is able to return a location header and different request types:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="mailto:ResponseDocument=XXXX&#37;&#52;&#48;asReference=true">ResponseDocument=XXXX<span>&#64;</span>asReference=true</a></p></li>
</ul>
</div></blockquote>
<p>In this case, ZOO-Kernel will return the GetMap/GetFeature/GetCoverage request as KVP in the <em>href</em> of the result.</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="mailto:ResponseDocument=XXXX&#37;&#52;&#48;asReference=false">ResponseDocument=XXXX<span>&#64;</span>asReference=false</a></p></li>
</ul>
</div></blockquote>
<p>In this case, ZOO-Kernel will return the result of the GetMap/GetFeature/GetCoverage request as KVP of the href used in the previous case.</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="mailto:RawDataOutput=XXXX&#37;&#52;&#48;asReference=true/false">RawDataOutput=XXXX<span>&#64;</span>asReference=true/false</a></p></li>
</ul>
</div></blockquote>
<p>In this case, ZOO-Kernel will return the GetMap/GetFeature/GetCoverage request as KVP in a specific location header, which implies that the browser is supposed to request MapServer directly.</p>
<p>Whatever the default output <em>mimeType</em> returned by a WPS service is, it is used if the <em>useMapserver</em> option is found at runtime. As an example, if <code class="docutils literal notranslate"><span class="pre">&lt;Default&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;Supported&gt;</span></code> blocks are found in the ZOO Service configuration file as shown bellow, this means that the service returns GML 3.1.0 features by default.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Default&gt;</span>
 mimeType = text/xml
 encoding = UTF-8
 schema = http://schemas.opengis.net/gml/3.1.0/base/feature.xsd
<span class="nt">&lt;/Default&gt;</span>
<span class="nt">&lt;Supported&gt;</span>
 mimeType = image/png
 useMapserver = true
<span class="nt">&lt;/Supported&gt;</span>
</pre></div>
</div>
</section>
<section id="installation-and-configuration">
<h2>Installation and configuration<a class="headerlink" href="#installation-and-configuration" title="Permalink to this heading">¶</a></h2>
<p>Follow the step described bellow in order to activate the ZOO-Project optional MapServer support.</p>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p>latest <a class="reference external" href="http://zoo-project.org/trac/browser/trunk/zoo-project/zoo-kernel">ZOO-Kernel</a> trunk version</p></li>
<li><p><a class="reference external" href="http://mapserver/org">MapServer</a> version &gt;= 6.0.1</p></li>
</ul>
</div></blockquote>
<p>First download the lastest zoo-kernel by checking out the svn. Use the following command from do the directory where your previously checked out (in this example we will use <code class="docutils literal notranslate"><span class="pre">$PREV_SVN_CO</span></code> to design this directory).</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>svn checkout http://svn.zoo-project.org/svn/trunk/ $PREV_SVN_CO
cd $PREV_SVN_CO
</pre></div>
</div>
<p>Then uncompress the MapServer archive (ie. <code class="docutils literal notranslate"><span class="pre">mapserver-6.0.1.tar.bz2</span></code>) into <code class="docutils literal notranslate"><span class="pre">/tmp/zoo-ms-src</span></code>, and compile it using the following command:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>cd /tmp/zoo-ms-src/mapserver-6.0.1
./configure --with-ogr=/usr/bin/gdal-config --with-gdal=/usr/bin/gdal-config \
               --with-proj --with-curl --with-sos --with-wfsclient --with-wmsclient \
               --with-wcs --with-wfs --with-postgis --with-kml=yes --with-geos \
               --with-xml --with-xslt --with-threads --with-cairo
make
cp mapserv /usr/lib/cgi-bin
</pre></div>
</div>
<p>Once done, compile ZOO-Kernel with MapServer support from the <code class="docutils literal notranslate"><span class="pre">$PREV_SVN_CO</span></code> directory, using the following command:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>cd zoo-kernel
autoconf
./configure --with-python --with-mapserver=/tmp/zoo-ms-src/mapserver-6.0.1
make
sudo make install
</pre></div>
</div>
</section>
<section id="main-configuration-file">
<span id="kernel-mapserver-main-cfg"></span><h3>Main configuration file<a class="headerlink" href="#main-configuration-file" title="Permalink to this heading">¶</a></h3>
<p>Open and edit the <code class="docutils literal notranslate"><span class="pre">/usr/lib/cgi-bin/main.cfg</span></code> file, by adding the following content in the <code class="docutils literal notranslate"><span class="pre">[main]</span></code> section:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">dataPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">temp</span><span class="o">/</span><span class="w"></span>
<span class="n">mapserverAddress</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="o">/</span><span class="n">cgi</span><span class="o">-</span><span class="n">bin</span><span class="o">/</span><span class="n">mapserv</span><span class="w"></span>
</pre></div>
</div>
<p>You can also add the following lines to the <code class="docutils literal notranslate"><span class="pre">[main]</span></code> section, in case
you want to use a default style for Polygon, Lines and Points vector
layer.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">msStylePoly</span><span class="o">=</span><span class="n">STYLE</span> <span class="n">COLOR</span> <span class="mi">202</span> <span class="mi">109</span> <span class="mi">19</span> <span class="n">OUTLINECOLOR</span> <span class="mi">105</span> <span class="mi">105</span> <span class="mi">105</span> <span class="n">WIDTH</span> <span class="mi">3</span> <span class="kr">END</span>
<span class="n">msStyleLine</span><span class="o">=</span><span class="n">STYLE</span> <span class="n">OUTLINECOLOR</span> <span class="mi">202</span> <span class="mi">109</span> <span class="mi">19</span> <span class="n">WIDTH</span> <span class="mi">3</span> <span class="kr">END</span>
<span class="n">msStylePoint</span><span class="o">=</span><span class="n">STYLE</span> <span class="n">COLOR</span> <span class="mi">202</span> <span class="mi">109</span> <span class="mi">19</span> <span class="n">OUTLINECOLOR</span> <span class="mi">105</span> <span class="mi">105</span> <span class="mi">105</span> <span class="n">SYMBOL</span> <span class="mi">0</span> <span class="kr">SIZE</span> <span class="mi">14</span> <span class="kr">END</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dataPath</span></code> directory is mandatory and must belong to the Apache user.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">temp</span><span class="o">/</span><span class="w"></span>
<span class="n">chown</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">apache</span><span class="p">:</span><span class="n">apache</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">temp</span><span class="o">/</span><span class="w"></span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">symbols.sym</span></code> file is required in this directory. Create it and add the following content in it:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">SYMBOLSET</span>
<span class="n">SYMBOL</span>
  <span class="n">NAME</span> <span class="s">&quot;circle&quot;</span>
  <span class="kr">TYPE</span> <span class="n">ellipse</span>
  <span class="n">FILLED</span> <span class="n">true</span>
  <span class="n">POINTS</span>
    <span class="mi">1</span> <span class="mi">1</span>
  <span class="kr">END</span>
<span class="kr">END</span>
<span class="kr">END</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only one symbol definition is required (with any name) for the WMS service output.</p>
</div>
<p>The ZOO-Project optional MapServer support is activated at this step. Don’t forget to add the <code class="docutils literal notranslate"><span class="pre">mapserverAddress</span></code> and  <code class="docutils literal notranslate"><span class="pre">msOgcVersion</span></code> parameters to the <code class="docutils literal notranslate"><span class="pre">main.cfg</span></code> file in order to  to specify the path to MapServer and the OGC WebService version used by the Services.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>ZOO-kernel will segfault (checking <code class="docutils literal notranslate"><span class="pre">NULL</span></code> value should correct this behavior) if the <code class="docutils literal notranslate"><span class="pre">mapserverAddress</span></code> parameter is not found</p>
</div>
</section>
<section id="service-configuration-file">
<h3>Service configuration file<a class="headerlink" href="#service-configuration-file" title="Permalink to this heading">¶</a></h3>
<section id="usemapserver">
<h4>useMapserver<a class="headerlink" href="#usemapserver" title="Permalink to this heading">¶</a></h4>
<p>In order to activate the MapServer WMS/WFS/WCS output for a specific service, the <code class="docutils literal notranslate"><span class="pre">useMapserver</span></code> parameter must be added to the <code class="docutils literal notranslate"><span class="pre">&lt;Default&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;Supported&gt;</span></code> blocks of the Service <cite>services-zcfg</cite>. If <code class="docutils literal notranslate"><span class="pre">useMapserver=true</span></code>, this means that the output result of the Service is a GDAL compatible datasource and that you want it to be automatically published by MapServer as WMS,WFS or WCS.</p>
<p>When the useMapserver option is used in a <code class="docutils literal notranslate"><span class="pre">&lt;Default&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;Supported&gt;</span></code> block, then you have to know what are the corresponding mimeType:</p>
<blockquote>
<div><ul class="simple">
<li><p>text/xml: Implies that the output data will be accessible through a WFS GetFeature request (default protocol version 1.1.0)</p></li>
<li><p>image/tiff: Implies that the output data will be accessible through a WCS GetCoverage request (default protocol version 2.0.0)</p></li>
<li><p>any other mimeType coupled with useMapserver option: Implies that the output data will be accessible through a WMS GetMap request (default protocol version 1.3.0). You can check the supported output mimeType by sending a GetCapabilities request to MapServer.</p></li>
</ul>
</div></blockquote>
<p>You get the same optional parameter <code class="docutils literal notranslate"><span class="pre">msOgcVersion</span></code> as for the <code class="docutils literal notranslate"><span class="pre">main.cfg</span></code>. This will specify that this is the specific protocol version the service want to use (so you may set also locally to service rather than globally).</p>
</section>
<section id="styling">
<h4>Styling<a class="headerlink" href="#styling" title="Permalink to this heading">¶</a></h4>
<p>You have different options to define the style of the layer created
using the data returned by your service.</p>
<section id="msstyle">
<h5>msStyle<a class="headerlink" href="#msstyle" title="Permalink to this heading">¶</a></h5>
<p>The optional <code class="docutils literal notranslate"><span class="pre">msStyle</span></code> parameter can also be used to define a custom MapServer style block (used for vector datasource only), as follow:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">msStyle</span> <span class="o">=</span> <span class="n">STYLE</span> <span class="n">COLOR</span> <span class="mi">125</span> <span class="mi">0</span> <span class="mi">105</span> <span class="n">OUTLINECOLOR</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="n">WIDTH</span> <span class="mi">3</span> <span class="kr">END</span>
</pre></div>
</div>
</section>
<section id="msclassify">
<h5>msClassify<a class="headerlink" href="#msclassify" title="Permalink to this heading">¶</a></h5>
<p>If a WPS service outputs a one band raster file, then it is possible
to add a <code class="docutils literal notranslate"><span class="pre">msClassify</span></code> parameter and set it to <code class="docutils literal notranslate"><span class="pre">true</span></code> in the output
ComplexData <code class="docutils literal notranslate"><span class="pre">&lt;Default&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;Supported&gt;</span></code> nodes of its zcfg
file. This allows ZOO-Kernel to use its own default style definitions
in order to classify the raster using equivalent intervals.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>msClassify = true
</pre></div>
</div>
</section>
<section id="msinclude">
<h5>msInclude<a class="headerlink" href="#msinclude" title="Permalink to this heading">¶</a></h5>
<p>In case you want to use another layer which use the result of your
service, for instance to produce a <a class="reference external" href="https://mapserver.org/output/kerneldensity.html">heatmap</a>, then you can use
the
<code class="docutils literal notranslate"><span class="pre">msInclude</span></code> and <code class="docutils literal notranslate"><span class="pre">msLayer</span></code> options in the output <code class="docutils literal notranslate"><span class="pre">ComplexData</span></code>
<code class="docutils literal notranslate"><span class="pre">&lt;Default&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;Supported&gt;</span></code> nodes of its zcfg file. You can see below an
example of use of this two options with the associated mapfile.</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">msInclude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">template</span><span class="o">.</span><span class="n">map</span><span class="w"></span>
<span class="n">msLayer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">heatmap</span><span class="w"></span>
</pre></div>
</div>
<p>You can find below a sample <code class="docutils literal notranslate"><span class="pre">/var/data/template.map</span></code>:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">MAP</span>
  <span class="kr">SIZE</span> <span class="mi">1000</span> <span class="mi">500</span>
  <span class="n">EXTENT</span> <span class="o">-</span><span class="mi">180</span> <span class="o">-</span><span class="mi">90</span> <span class="mi">180</span> <span class="mi">90</span>
  <span class="n">NAME</span> <span class="s">&quot;test heat&quot;</span>
  <span class="n">IMAGETYPE</span> <span class="s">&quot;png&quot;</span>

  <span class="n">WEB</span>
    <span class="n">METADATA</span>
      <span class="s">&quot;ows_srs&quot;</span> <span class="s">&quot;epsg:4326  epsg:3857 epsg:900913&quot;</span>
      <span class="s">&quot;ows_enable_request&quot;</span> <span class="s">&quot;*&quot;</span>
    <span class="kr">END</span> <span class="o">#</span> <span class="n">METADATA</span>
  <span class="kr">END</span> <span class="o">#</span> <span class="n">WEB</span>

  <span class="n">PROJECTION</span>
    <span class="s">&quot;+init=epsg:4326&quot;</span>
  <span class="kr">END</span> <span class="o">#</span> <span class="n">PROJECTION</span>

  <span class="n">LAYER</span>
    <span class="n">NAME</span> <span class="s">&quot;heatmap&quot;</span> <span class="o">#</span> <span class="n">Corresponding</span> <span class="n">to</span> <span class="n">the</span> <span class="n">msLayer</span> <span class="n">defined</span>
    <span class="kr">TYPE</span> <span class="n">raster</span>
    <span class="n">CONNECTIONTYPE</span> <span class="n">kerneldensity</span>
    <span class="n">CONNECTION</span> <span class="s">&quot;Result&quot;</span>
    <span class="n">STATUS</span> <span class="n">on</span>
    <span class="n">PROCESSING</span> <span class="s">&quot;RANGE_COLORSPACE=HSL&quot;</span>
    <span class="n">PROCESSING</span> <span class="s">&quot;KERNELDENSITY_RADIUS=20&quot;</span>
    <span class="n">PROCESSING</span> <span class="s">&quot;KERNELDENSITY_COMPUTE_BORDERS=ON&quot;</span>
    <span class="n">PROCESSING</span> <span class="s">&quot;KERNELDENSITY_NORMALIZATION=AUTO&quot;</span>
    <span class="n">OFFSITE</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
    <span class="n">CLASS</span>
      <span class="n">STYLE</span>
        <span class="n">COLORRANGE</span>  <span class="s">&quot;#0000ff00&quot;</span>  <span class="s">&quot;#0000ffff&quot;</span>
        <span class="n">DATARANGE</span> <span class="mi">0</span> <span class="mi">32</span>
      <span class="kr">END</span> <span class="o">#</span> <span class="n">STYLE</span>
      <span class="n">STYLE</span>
        <span class="n">COLORRANGE</span>  <span class="s">&quot;#0000ffff&quot;</span>  <span class="s">&quot;#ff0000ff&quot;</span>
        <span class="n">DATARANGE</span> <span class="mi">32</span> <span class="mi">255</span>
      <span class="kr">END</span> <span class="o">#</span> <span class="n">STYLE</span>
    <span class="kr">END</span> <span class="o">#</span> <span class="n">CLASS</span>
  <span class="kr">END</span> <span class="o">#</span> <span class="n">LAYER</span>

  <span class="n">LAYER</span>
    <span class="n">NAME</span> <span class="s">&quot;points&quot;</span>
    <span class="n">STATUS</span> <span class="n">on</span>
    <span class="kr">TYPE</span> <span class="n">POINT</span>
    <span class="o">#</span><span class="n">DATA</span> <span class="s">&quot;/Library/WebServer/cache//ef76ee6642c1ea704e847e28120ba1ca.zca&quot;</span>
  <span class="kr">END</span> <span class="o">#</span> <span class="n">LAYER</span>
<span class="kr">END</span> <span class="o">#</span> <span class="n">MAPFILE</span>
</pre></div>
</div>
</section>
</section>
<section id="example">
<h4>Example<a class="headerlink" href="#example" title="Permalink to this heading">¶</a></h4>
<p>An example <a class="reference internal" href="../services/zcfg-reference.html#services-zcfg"><span class="std std-ref">ZOO-Service configuration file</span></a> file configured for the optional MapServer support is shown bellow:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Default&gt;</span>
 mimeType = text/xml
 encoding = UTF-8
 schema = http://schemas.opengis.net/gml/3.1.0/base/feature.xsd
 useMapserver = true
<span class="nt">&lt;/Default&gt;</span>
<span class="nt">&lt;Supported&gt;</span>
 mimeType = image/png
 useMapserver = true
 asReference = true
 msStyle = STYLE COLOR 125 0 105 OUTLINECOLOR 0 0 0 WIDTH 3 END
<span class="nt">&lt;/Supported&gt;</span>
<span class="nt">&lt;Supported&gt;</span>
 mimeType = application/vnd.google-earth.kmz
 useMapserver = true
 asReference = true
 msStyle = STYLE COLOR 125 0 105 OUTLINECOLOR 0 0 0 WIDTH 3 END
<span class="nt">&lt;/Supported&gt;</span>
<span class="nt">&lt;Supported&gt;</span>
 mimeType = image/tif
 useMapserver = true
 asReference = true
 msClassify = true
<span class="nt">&lt;/Supported&gt;</span>
</pre></div>
</div>
<p>In this example, the default output <code class="docutils literal notranslate"><span class="pre">mimeType</span></code> is <code class="docutils literal notranslate"><span class="pre">image/png</span></code>, so a WMS GetMap request will be returned, or the resulting <code class="docutils literal notranslate"><span class="pre">image/tiff</span></code> will be returned as WCS GetCoverage request.</p>
</section>
</section>
</section>
<section id="test-requests">
<h2>Test requests<a class="headerlink" href="#test-requests" title="Permalink to this heading">¶</a></h2>
<p>The optional MapServer support can be tested using any service. The
simple <em>HelloPy</em> Service is used in the following example requests.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following examples require a zip file containing a Shapefile (<a class="reference external" href="http://localhost/data/data.zip">http://localhost/data/data.zip</a>) and a tif file (<a class="reference external" href="http://localhost/data/demo.tif">http://localhost/data/demo.tif</a>)</p>
</div>
<p>Accessing a remote Zipped Shapefile as WFS GetFeatures Request:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>http://localhost/cgi-bin/zoo_loader.cgi?request=Execute&amp;service=WPS&amp;version=1.0.0&amp;Identifier=HelloPy&amp;DataInputs=a=Reference@xlink:href=http://localhost/data/data.zip&amp;ResponseDocument=Result@asReference=true@mimetype=text/xml
</pre></div>
</div>
<p>Accessing a remote Zipped Shapefile as WMS GetMap Request:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>http://localhost/cgi-bin/zoo_loader.cgi?request=Execute&amp;service=WPS&amp;version=1.0.0&amp;Identifier=HelloPy&amp;DataInputs=a=Reference@xlink:href=http://localhost/data/data.zip&amp;ResponseDocument=Result@asReference=true@mimetype=image/png
</pre></div>
</div>
<p>Accessing a remote tiff as WMS GetMap Request:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>http://localhost/cgi-bin/zoo_loader.cgi?request=Execute&amp;service=WPS&amp;version=1.0.0&amp;Identifier=HelloPy&amp;DataInputs=a=Reference@xlink:href=http://localhost/data/data.tiff&amp;ResponseDocument=Result@asReference=true@mimetype=image/png
</pre></div>
</div>
<p>Accessing a remote tiff as WCS GetMap Request:</p>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>http://localhost/cgi-bin/zoo_loader.cgi?request=Execute&amp;service=WPS&amp;version=1.0.0&amp;Identifier=HelloPy&amp;DataInputs=a=Reference@xlink:href=http://localhost/data/data.tiff&amp;ResponseDocument=Result@asReference=true@mimetype=image/tiff
</pre></div>
</div>
</section>
</section>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="orfeotoolbox.html" class="btn btn-neutral float-right" title="Optional Orfeo Toolbox support">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="configuration.html" class="btn btn-neutral" title="ZOO-Kernel configuration"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>
  <div class="pfoot">
  <div role="contentinfo">
    <p>
        &copy; Copyright 2009-2022, ZOO-Project team. This work is released under a Creative Commons Attribution-ShareAlike 4.0 International Public License.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> inspired by <a href="https://readthedocs.org">Read the Docs</a>.
</div>
</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.9.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/documentation_options.js"></script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/sphinx_highlight.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>