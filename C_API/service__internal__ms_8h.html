<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ZOO-Project: service_internal_ms.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ZOO-Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">service_internal_ms.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &quot;<a class="el" href="service_8h_source.html">service.h</a>&quot;</code><br />
<code>#include &quot;cpl_conv.h&quot;</code><br />
<code>#include &quot;cpl_multiproc.h&quot;</code><br />
<code>#include &quot;ogr_api.h&quot;</code><br />
<code>#include &quot;gdal.h&quot;</code><br />
<code>#include &quot;ogr_srs_api.h&quot;</code><br />
<code>#include &lt;mapserver.h&gt;</code><br />
</div>
<p><a href="service__internal__ms_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa14fa0b26e34ddc01c24498561288493"><td class="memItemLeft" align="right" valign="top"><a class="el" href="service_8h.html#structmap">map</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="service__internal__ms_8h.html#aa14fa0b26e34ddc01c24498561288493">getCorrespondance</a> ()</td></tr>
<tr class="memdesc:aa14fa0b26e34ddc01c24498561288493"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a list of configuration keys having a corresponding mandatory ows_*.  <a href="service__internal__ms_8h.html#aa14fa0b26e34ddc01c24498561288493">More...</a><br /></td></tr>
<tr class="separator:aa14fa0b26e34ddc01c24498561288493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87ef68ec7c6b1ed3c7cf82fd90f28f15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="service__internal__ms_8h.html#a87ef68ec7c6b1ed3c7cf82fd90f28f15">setMapSize</a> (<a class="el" href="service_8h.html#structmaps">maps</a> *output, double minx, double miny, double maxy, double maxx)</td></tr>
<tr class="memdesc:a87ef68ec7c6b1ed3c7cf82fd90f28f15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add width and height keys to an output maps containing the maximum width and height for displaying the full data extent.  <a href="service__internal__ms_8h.html#a87ef68ec7c6b1ed3c7cf82fd90f28f15">More...</a><br /></td></tr>
<tr class="separator:a87ef68ec7c6b1ed3c7cf82fd90f28f15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affbc5942c996c2ea0c6ea48dd14bdd5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="service__internal__ms_8h.html#affbc5942c996c2ea0c6ea48dd14bdd5d">setReferenceUrl</a> (<a class="el" href="service_8h.html#structmaps">maps</a> *m, <a class="el" href="service_8h.html#structmaps">maps</a> *tmpI)</td></tr>
<tr class="memdesc:affbc5942c996c2ea0c6ea48dd14bdd5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a Reference key to an output containing the WMFS/WFS/WCS request for accessing service result.  <a href="service__internal__ms_8h.html#affbc5942c996c2ea0c6ea48dd14bdd5d">More...</a><br /></td></tr>
<tr class="separator:affbc5942c996c2ea0c6ea48dd14bdd5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a287f2055cd6244f9d8fe64b1eebca4ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="service__internal__ms_8h.html#a287f2055cd6244f9d8fe64b1eebca4ab">setSrsInformations</a> (<a class="el" href="service_8h.html#structmaps">maps</a> *output, mapObj *m, layerObj *myLayer, char *pszProjection)</td></tr>
<tr class="memdesc:a287f2055cd6244f9d8fe64b1eebca4ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set projection for a layer in a MAPFILE using Authority Code and Name if available or fallback to proj4 definition if available or fallback to default EPSG:4326.  <a href="service__internal__ms_8h.html#a287f2055cd6244f9d8fe64b1eebca4ab">More...</a><br /></td></tr>
<tr class="separator:a287f2055cd6244f9d8fe64b1eebca4ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3084597e7a3e3ed80dac83ef908294fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="service__internal__ms_8h.html#a3084597e7a3e3ed80dac83ef908294fe">setMsExtent</a> (<a class="el" href="service_8h.html#structmaps">maps</a> *output, mapObj *m, layerObj *myLayer, double minX, double minY, double maxX, double maxY)</td></tr>
<tr class="memdesc:a3084597e7a3e3ed80dac83ef908294fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the MAPFILE extent, the the ows_extent for the layer, add wms_extent and wfs_extent to the output maps and call setMapSize.  <a href="service__internal__ms_8h.html#a3084597e7a3e3ed80dac83ef908294fe">More...</a><br /></td></tr>
<tr class="separator:a3084597e7a3e3ed80dac83ef908294fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe8ef9017239515901f2679b178fcc54"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="service__internal__ms_8h.html#abe8ef9017239515901f2679b178fcc54">tryOgr</a> (<a class="el" href="service_8h.html#structmaps">maps</a> *conf, <a class="el" href="service_8h.html#structmaps">maps</a> *output, mapObj *m)</td></tr>
<tr class="memdesc:abe8ef9017239515901f2679b178fcc54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to open a vector output and define the corresponding layer in the MAPFILE.  <a href="service__internal__ms_8h.html#abe8ef9017239515901f2679b178fcc54">More...</a><br /></td></tr>
<tr class="separator:abe8ef9017239515901f2679b178fcc54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace80e7fae9690e7cd13657c2be7f2a21"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="service__internal__ms_8h.html#ace80e7fae9690e7cd13657c2be7f2a21">tryGdal</a> (<a class="el" href="service_8h.html#structmaps">maps</a> *conf, <a class="el" href="service_8h.html#structmaps">maps</a> *output, mapObj *m)</td></tr>
<tr class="memdesc:ace80e7fae9690e7cd13657c2be7f2a21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to open a raster output and define the corresponding layer in the MAPFILE.  <a href="service__internal__ms_8h.html#ace80e7fae9690e7cd13657c2be7f2a21">More...</a><br /></td></tr>
<tr class="separator:ace80e7fae9690e7cd13657c2be7f2a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8296e66954b6058beb929bdc6415045"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="service__internal__ms_8h.html#ad8296e66954b6058beb929bdc6415045">outputMapfile</a> (<a class="el" href="service_8h.html#structmaps">maps</a> *conf, <a class="el" href="service_8h.html#structmaps">maps</a> *outputs)</td></tr>
<tr class="memdesc:ad8296e66954b6058beb929bdc6415045"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a MapFile for WMS, WFS or WCS Service output.  <a href="service__internal__ms_8h.html#ad8296e66954b6058beb929bdc6415045">More...</a><br /></td></tr>
<tr class="separator:ad8296e66954b6058beb929bdc6415045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49906d47220e34663fa3fdfcb59c357"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="service__internal__ms_8h.html#ac49906d47220e34663fa3fdfcb59c357">saveMapNames</a> (<a class="el" href="service_8h.html#structmaps">maps</a> *, <a class="el" href="service_8h.html#structmaps">maps</a> *, char *)</td></tr>
<tr class="memdesc:ac49906d47220e34663fa3fdfcb59c357"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the map fullpath in a text file (.maps)  <a href="service__internal__ms_8h.html#ac49906d47220e34663fa3fdfcb59c357">More...</a><br /></td></tr>
<tr class="separator:ac49906d47220e34663fa3fdfcb59c357"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa14fa0b26e34ddc01c24498561288493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa14fa0b26e34ddc01c24498561288493">&#9670;&nbsp;</a></span>getCorrespondance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="service_8h.html#structmap">map</a>* getCorrespondance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a list of configuration keys having a corresponding mandatory ows_*. </p>
<p>Map composed by a main.cfg maps name as key and the corresponding MapServer Mafile Metadata name to use see doc from here :</p><ul>
<li><a href="http://mapserver.org/ogc/wms_server.html">http://mapserver.org/ogc/wms_server.html</a></li>
<li><a href="http://mapserver.org/ogc/wfs_server.html">http://mapserver.org/ogc/wfs_server.html</a></li>
<li><a href="http://mapserver.org/ogc/wcs_server.html">http://mapserver.org/ogc/wcs_server.html</a></li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>a new map containing a table linking a name of a configuration key to a corresponding mandatory ows_* keyword (ie. "fees" =&gt; "ows_fees"). </dd></dl>

</div>
</div>
<a id="ad8296e66954b6058beb929bdc6415045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8296e66954b6058beb929bdc6415045">&#9670;&nbsp;</a></span>outputMapfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void outputMapfile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>outputs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a MapFile for WMS, WFS or WCS Service output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conf</td><td>the conf maps containing the main.cfg settings </td></tr>
    <tr><td class="paramname">outputs</td><td>a specific output maps </td></tr>
  </table>
  </dd>
</dl>
<p>First store the value on disk</p>
<p>Set a ows_rootlayer_title, <br  />
</p>
<p>Enable all the WXS requests using ows_enable_request see <a href="http://mapserver.org/trunk/development/rfc/ms-rfc-67.html">http://mapserver.org/trunk/development/rfc/ms-rfc-67.html</a></p>
<p>Set metadata extracted from main.cfg file maps</p>

</div>
</div>
<a id="ac49906d47220e34663fa3fdfcb59c357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49906d47220e34663fa3fdfcb59c357">&#9670;&nbsp;</a></span>saveMapNames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void saveMapNames </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>mapfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save the map fullpath in a text file (.maps) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conf</td><td>the main configuration map pointer </td></tr>
    <tr><td class="paramname">output</td><td>the current output for which a mapfile has been generated </td></tr>
    <tr><td class="paramname">mapfile</td><td>the mapfile saved to store in the text file </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a87ef68ec7c6b1ed3c7cf82fd90f28f15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87ef68ec7c6b1ed3c7cf82fd90f28f15">&#9670;&nbsp;</a></span>setMapSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setMapSize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>miny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add width and height keys to an output maps containing the maximum width and height for displaying the full data extent. </p>
<p>Restriction to an image having a size of 640x480 (width * height)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td></td></tr>
    <tr><td class="paramname">minx</td><td>the lower left x coordinate </td></tr>
    <tr><td class="paramname">miny</td><td>the lower left y coordinate </td></tr>
    <tr><td class="paramname">maxx</td><td>the upper right x coordinate </td></tr>
    <tr><td class="paramname">maxy</td><td>the upper right y coordinate </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3084597e7a3e3ed80dac83ef908294fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3084597e7a3e3ed80dac83ef908294fe">&#9670;&nbsp;</a></span>setMsExtent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setMsExtent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mapObj *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">layerObj *&#160;</td>
          <td class="paramname"><em>myLayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the MAPFILE extent, the the ows_extent for the layer, add wms_extent and wfs_extent to the output maps and call setMapSize. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>the specific output </td></tr>
    <tr><td class="paramname">m</td><td>the mapObj </td></tr>
    <tr><td class="paramname">myLayer</td><td>the layerObj </td></tr>
    <tr><td class="paramname">minX</td><td>the lower left x coordinate </td></tr>
    <tr><td class="paramname">minY</td><td>the lower left y coordinate </td></tr>
    <tr><td class="paramname">maxX</td><td>the upper right x coordinate </td></tr>
    <tr><td class="paramname">maxY</td><td>the upper right y coordinate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="service__internal__ms_8c.html#aa6e270e423418db2f29500ca117412db" title="Add width and height keys to an output maps containing the maximum width and height for displaying th...">setMapSize</a> </dd></dl>

</div>
</div>
<a id="affbc5942c996c2ea0c6ea48dd14bdd5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affbc5942c996c2ea0c6ea48dd14bdd5d">&#9670;&nbsp;</a></span>setReferenceUrl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setReferenceUrl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>tmpI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a Reference key to an output containing the WMFS/WFS/WCS request for accessing service result. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>the conf maps containing the main.cfg settings </td></tr>
    <tr><td class="paramname">tmpI</td><td>the specific output maps to add the Reference key </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a287f2055cd6244f9d8fe64b1eebca4ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a287f2055cd6244f9d8fe64b1eebca4ab">&#9670;&nbsp;</a></span>setSrsInformations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setSrsInformations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mapObj *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">layerObj *&#160;</td>
          <td class="paramname"><em>myLayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pszProjection</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set projection for a layer in a MAPFILE using Authority Code and Name if available or fallback to proj4 definition if available or fallback to default EPSG:4326. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>the output maps </td></tr>
    <tr><td class="paramname">m</td><td>the opened mapObj </td></tr>
    <tr><td class="paramname">myLayer</td><td>the layerObj </td></tr>
    <tr><td class="paramname">pszProjection</td><td>a char* containing the SRS definition in WKT format </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ace80e7fae9690e7cd13657c2be7f2a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace80e7fae9690e7cd13657c2be7f2a21">&#9670;&nbsp;</a></span>tryGdal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tryGdal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mapObj *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to open a raster output and define the corresponding layer in the MAPFILE. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conf</td><td>the conf maps containing the main.cfg settings </td></tr>
    <tr><td class="paramname">output</td><td>the specific output maps </td></tr>
    <tr><td class="paramname">m</td><td>the mapObj </td></tr>
  </table>
  </dd>
</dl>
<p>Try to open the DataSource using GDAL</p>
<p>Add a new layer set name, data</p>
<p>Set Map Size to the raster size</p>
<p>Set projection using Authority Code and Name if available or fallback to proj4 definition if available or fallback to default EPSG:4326</p>
<p>Set extent</p>
<p>Extract information about available bands to set the bandcount and the processing directive</p>
<p>Name available Bands</p>
<p>Loops over metadata information to setup specific information</p>
<p>Classify one band raster pixel value using regular interval</p>
<p>Create a new class</p>
<p>Set class name</p>
<p>Set expression</p>
<p>Set color</p>

</div>
</div>
<a id="abe8ef9017239515901f2679b178fcc54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe8ef9017239515901f2679b178fcc54">&#9670;&nbsp;</a></span>tryOgr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tryOgr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="service_8h.html#structmaps">maps</a> *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mapObj *&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to open a vector output and define the corresponding layer in the MAPFILE. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conf</td><td>the conf maps containing the main.cfg settings </td></tr>
    <tr><td class="paramname">output</td><td>the specific output maps </td></tr>
    <tr><td class="paramname">m</td><td>the mapObj </td></tr>
  </table>
  </dd>
</dl>
<p>Try to open the DataSource using OGR</p>
<pre class="fragment"> Try to load the file as ZIP
</pre><p>OGRDataSourceH poDS1 = NULL; OGRSFDriverH <em>poDriver1 = NULL; char *dsName=(char</em>)malloc((8+strlen(pszDataSource)+1)*sizeof(char)); char *odsName=<a class="el" href="service_8h.html#a7023bf657df424d300a3ec75a8dedbf2" title="The crossplatform strdup alias.">zStrdup(pszDataSource)</a>; char *sdsName=<a class="el" href="service_8h.html#a7023bf657df424d300a3ec75a8dedbf2" title="The crossplatform strdup alias.">zStrdup(pszDataSource)</a>; char *demo=".data"; sdsName[strlen(sdsName)-(strlen(demo)-1)]='d'; sdsName[strlen(sdsName)-(strlen(demo)-2)]='i'; sdsName[strlen(sdsName)-(strlen(demo)-3)]='r'; sdsName[strlen(sdsName)-(strlen(demo)-4)]=0;</p>
<p>odsName[strlen(odsName)-(strlen(demo)-1)]='z'; odsName[strlen(odsName)-(strlen(demo)-2)]='i'; odsName[strlen(odsName)-(strlen(demo)-3)]='p'; odsName[strlen(odsName)-(strlen(demo)-4)]=0; sprintf(dsName,"/vsizip/%s",odsName);</p>
<p>#ifdef DEBUGMS fprintf(stderr,"Try loading %s, %s, %s\n",dsName,odsName,dsName); #endif</p>
<p>FILE* file = fopen(pszDataSource, "rb"); FILE* fileZ = fopen(odsName, "wb"); free(odsName); fseek(file, 0, SEEK_END); unsigned long fileLen=ftell(file); fseek(file, 0, SEEK_SET); char *buffer=(char *)malloc(fileLen+1); fread(buffer, fileLen, 1, file); fwrite(buffer,fileLen, 1, fileZ); fclose(file); fclose(fileZ); free(buffer); #ifdef DEBUGMS fprintf(stderr,"Try loading %s",dsName); #endif poDS1 = OGROpen( dsName, FALSE, poDriver1 ); if( poDS1 == NULL ){ fprintf(stderr,"Unable to access the DataSource as ZIP File\n"); setMapInMaps(conf,"lenv","message","Unable to open datasource in read only mode"); fprintf(stderr,"Remove ZIP File!\n"); unlink(odsName); OGR_DS_Destroy(poDS1); }else{ #ifdef DEBUGMS fprintf(stderr,"The DataSource is a  ZIP File\n"); #endif char** demo=VSIReadDir(dsName); int i=0; zMkdir(sdsName #ifndef WIN32 ,S_IRWXU | S_IRGRP | S_IXGRP | S_IROTH | S_IXOTH #endif ); while(demo[i]!=NULL){ #ifdef DEBUGMS fprintf(stderr,"ZIP File content : %s\n",demo[i]); #endif char <em>tmpDs=(char</em>)malloc((strlen(dsName)+strlen(demo[i])+2)*sizeof(char)); sprintf(tmpDs,"%s/%s",dsName,demo[i]); fprintf(stderr,"read : %s\n",tmpDs);</p>
<p>VSILFILE* vsif=VSIFOpenL(tmpDs,"rb"); #ifdef DEBUGMS fprintf(stderr,"open : %s\n",tmpDs); #endif VSIFSeekL(vsif,0,SEEK_END); vsi_l_offset size=VSIFTellL(vsif); #ifdef DEBUGMS fprintf(stderr,"size : %d\n",size); #endif VSIFSeekL(vsif,0,SEEK_SET); char <em>vsifcontent=(char</em>) malloc(((int)size+1)*sizeof(char)); VSIFReadL(vsifcontent,1,(size_t)size,vsif); char <em>fpath=(char</em>) malloc((strlen(sdsName)+strlen(demo[1])+2)*sizeof(char)); sprintf(fpath,"%s/%s",sdsName,demo[i]); int f=zOpen(fpath,O_WRONLY|O_CREAT,S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH); <a class="el" href="service_8h.html#a34f66378d374f50e8ffc995f5b1e10ae" title="The crossplatform write alias.">zWrite(f,vsifcontent,(int)size)</a>; close(f); chmod(fpath,S_IRWXU | S_IRGRP | S_IXGRP | S_IROTH); char* tmpP=strstr(fpath,".shp"); if(tmpP==NULL) tmpP=strstr(fpath,".SHP"); if(tmpP!=NULL){ #ifdef DEBUGMS fprintf(stderr,"*** DEBUG %s\n",strstr(tmpP,".")); #endif if( strcmp(tmpP,".shp")==0 || strcmp(tmpP,".SHP")==0 ){ tmpMap=getMap(output-&gt;content,"storage"); free(tmpMap-&gt;value); tmpMap-&gt;value=(char*) malloc((strlen(fpath)+1)*sizeof(char)); sprintf(tmpMap-&gt;value,"%s",fpath); pszDataSource=tmpMap-&gt;value; #ifdef DEBUGMS fprintf(stderr,"*** DEBUG %s\n",pszDataSource); #endif } } VSIFCloseL(vsif); i++; } OGR_DS_Destroy(poDS1); } free(sdsName); free(dsName);</p>
<p>Add a new layer set name, data</p>
<p>Detect the Geometry Type or use Polygon</p>
<p>Detect spatial reference or use WGS84</p>
<p>Detect the FID column or use the first attribute field as FID</p>
<p>Apply msStyle else fallback to the default style</p>
<p>Set style</p>
<p>Set specific style depending on type</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 25 2023 09:28:47 for ZOO-Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
